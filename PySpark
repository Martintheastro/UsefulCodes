
# Creating Pivot table, grouping by "ByuingGroup" and columns will be "Category"
df=spark.read.table("dimension_customer")\
    .groupBy("BuyingGroup")\
    .pivot("Category")\
    .count()

display(df)

###################################################################################

df = spark.sql("SELECT * FROM ShortcutExercise.dimension_customer WHERE Category <> 'Novelty Shop' LIMIT 1000") 

display(df)
